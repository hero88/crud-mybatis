<!DOCTYPE html>
<html>

<head>
	<title>CoinMarketCap</title>
	<meta charset="UTF-8">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<style>
		.hsdhf h1 {
			margin: 0;
		}

		.hsdhf nav {
			display: flex;
			align-items: center;
		}

		.hsdhf nav a {
			color: #1c1c1c;
			margin-left: 20px;
			text-decoration: none;
			font-family: Inter, -apple-system, BlinkMacSystemFont, segoe ui, Roboto, Helvetica, Arial, sans-serif;
			;
		}

		table {
			border-collapse: collapse;
			width: 100%;
		}

		th,
		td {
			border: 1px solid #ddd;
			padding: 8px;
			text-align: left;
		}

		tr:nth-child(even) {
			background-color: #f2f2f2;
		}

		tr:hover {
			background-color: #ddd;
		}

		.hDjzmZ {
			font-size: var(--c-font-size-100);
			font-weight: var(--c-font-weight-600);
			cursor: pointer;
		}

		.jyVQAz {
			height: 16px;
			width: 1px;
			margin: 0px 16px;
			background: rgb(207, 214, 228);
			flex-shrink: 0;
		}
	</style>
</head>

<body style="background-color: #fff;">
	<!-- <div class="container-xxl"> -->
	<!-- <div class="row hsdhf"> -->
	<!-- <div class="container-fluid" id="loginContainer" style="display: none;">
		<div class="row justify-content-end pt-2">
			<div class="col-auto">
				<a class="btn btn-primary" href="../../html/page/SignInSignUp.html">Login</a>
			</div>
		</div>
	</div> -->

	<nav class="navbar navbar-expand-xxl pb-5">
		<div class="container-fluid">
			<img class="rounded-circle me-2" style="height: 50px;width: 50px;" src="../../img/logo.jpg">
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
				aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav me-auto mb-2 mb-xxl-0">
					<!-- <li class="nav-item">
						<a class="nav-link active" aria-current="page"
							href="../../html/page/home.html">Cryptocurrencies</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="../../html/page/dashboard.html">Dashboard</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="../../html/page/coin_management.html">User coin</a>
					</li> -->
					<li class="nav-item">
						<a class="nav-link" href="../../html/page/company.html">Company</a>
					</li>
				</ul>
				<div class="dropdown">
					<div class="row p-2" style="display: none;" id="buttonLogin">
						<a class="btn btn-primary" href="../../html/page/SignInSignUp.html">Login</a>
					</div>
					<div class="row" style="display: none;" id="menu">
						<a class="align-items-center link-dark text-decoration-none" href="#" id="dropdownUser1"
							data-bs-toggle="dropdown" aria-expanded="false">
							<img src="../../img/user.png" alt="Profile Picture" width="32" height="32"
								class="rounded-circle me-2">
							<span id="name"></span>
						</a>

						<ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
							<li><a class="dropdown-item" href="../../html/user/user-profile.html"><svg
										xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
										class="bi bi-person-circle" viewBox="0 0 16 16">
										<path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
										<path fill-rule="evenodd"
											d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
									</svg> Profile</a></li>
							<li><a class="dropdown-item" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="16"
										height="16" fill="currentColor" class="bi bi-shield-lock" viewBox="0 0 16 16">
										<path
											d="M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56" />
										<path
											d="M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415" />
									</svg> Change Password</a></li>
							<li><button class="dropdown-item" id="logoutButton"><svg xmlns="http://www.w3.org/2000/svg"
										width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right"
										viewBox="0 0 16 16">
										<path fill-rule="evenodd"
											d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z" />
										<path fill-rule="evenodd"
											d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z" />
									</svg> Logout</button></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<!-- </div> -->
	<!-- </div> -->
	<div class="container-xxl" style="background-color: #fff;">
		<div class="row pb-2">
			<div class="col-md-8">
				<!-- Left side content -->
				<div style="display: flex;">
					<button class="btn border btn-light p-2" style="background-color: #FFF;" type="button">
						<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" height="1em"
							width="1em" class="sc-f70bb44c-0 fDjslW c-i" loading="lazy">
							<path fill-rule="evenodd" clip-rule="evenodd"
								d="M5.80195 9.1961V5.79609H9.20196V9.1961H5.80195ZM4.00195 5.49609C4.00195 4.66767 4.67352 3.99609 5.50195 3.99609H9.50196C10.3304 3.99609 11.002 4.66767 11.002 5.49609V9.4961C11.002 10.3245 10.3304 10.9961 9.50196 10.9961H5.50195C4.67352 10.9961 4.00195 10.3245 4.00195 9.4961V5.49609ZM14.802 9.1961V5.79609H18.2019V9.1961H14.802ZM13.002 5.49609C13.002 4.66767 13.6735 3.99609 14.502 3.99609H18.5019C19.3303 3.99609 20.0019 4.66767 20.0019 5.49609V9.4961C20.0019 10.3245 19.3303 10.9961 18.5019 10.9961H14.502C13.6735 10.9961 13.002 10.3245 13.002 9.4961V5.49609ZM14.802 14.7961V18.1961H18.2019V14.7961H14.802ZM14.502 12.9961C13.6735 12.9961 13.002 13.6677 13.002 14.4961V18.4961C13.002 19.3245 13.6735 19.9961 14.502 19.9961H18.5019C19.3303 19.9961 20.0019 19.3245 20.0019 18.4961V14.4961C20.0019 13.6677 19.3303 12.9961 18.5019 12.9961H14.502ZM5.80195 18.1961V14.7961H9.20196V18.1961H5.80195ZM4.00195 14.4961C4.00195 13.6677 4.67352 12.9961 5.50195 12.9961H9.50196C10.3304 12.9961 11.002 13.6677 11.002 14.4961V18.4961C11.002 19.3245 10.3304 19.9961 9.50196 19.9961H5.50195C4.67352 19.9961 4.00195 19.3245 4.00195 18.4961V14.4961Z"
								fill="currentColor"></path>
						</svg> <b style="font-size: 12px;">Cryptocurrencies</b></button>
					<button class="btn border btn-light p-2" style="background-color: #FFF;" type="button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
							class="bi bi-list" viewBox="0 0 16 16">
							<path fill-rule="evenodd"
								d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5" />
						</svg> <b style="font-size: 12px;">Categories</b></button>

					<button class="btn border btn-light" style="background-color: #FFF;" type="button">
						<b style="font-size: 12px;"> Solana Ecosystem</b></button>
					<button class="btn border btn-light" style="background-color: #FFF;" type="button">
						<b style="font-size: 12px;"> Inscriptions</b></button>
					<button class="btn border btn-light" style="background-color: #FFF;" type="button">
						<b style="font-size: 12px;"> DePin</b></button>
				</div>
				<!-- Your buttons go here -->
			</div>
			<div class="col-md-4">
				<!-- Right side content -->
				<div style="display: flex;justify-content: flex-end;">
					<select id="limitSelect" class="rounded-3 p-2" aria-label="Default select example"
						style="background-color: rgb(239, 242, 245); border: none;">
						<option value="100">100</option>
						<option value="50">50</option>
						<option value="20">20</option>
					</select>
					<button class="rounded-3 p-2"
						style="background-color: rgb(239, 242, 245); border: none; font-size: 12px;"><svg
							xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="16px" width="16px"
							viewBox="0 0 24 24" color="var(--c-color-gray-500)" class="sc-aef7b723-0 jHtKOX">
							<path fill-rule="evenodd" clip-rule="evenodd"
								d="M9 5C7.89543 5 7 5.89543 7 7C7 8.10457 7.89543 9 9 9C10.1046 9 11 8.10457 11 7C11 5.89543 10.1046 5 9 5ZM4.99805 8.00342C5.041 8.00342 5.08332 8.00071 5.12485 7.99545C5.56731 9.72299 7.13452 11 9 11C11.2091 11 13 9.20914 13 7C13 4.79086 11.2091 3 9 3C7.13214 3 5.56331 4.28028 5.12316 6.01117C5.08217 6.00605 5.04042 6.00342 4.99805 6.00342H2.99805C2.44576 6.00342 1.99805 6.45113 1.99805 7.00342C1.99805 7.5557 2.44576 8.00342 2.99805 8.00342H4.99805ZM16 6.00342C15.4477 6.00342 15 6.45113 15 7.00342C15 7.5557 15.4477 8.00342 16 8.00342H21C21.5523 8.00342 22 7.5557 22 7.00342C22 6.45113 21.5523 6.00342 21 6.00342H16ZM15 15C13.8954 15 13 15.8954 13 17C13 18.1046 13.8954 19 15 19C16.1046 19 17 18.1046 17 17C17 15.8954 16.1046 15 15 15ZM11 17C11 14.7909 12.7909 13 15 13C16.8666 13 18.4346 14.2785 18.8759 16.0076C18.916 16.0027 18.9569 16.0001 18.9983 16L20.9996 15.9966C21.5519 15.9956 22.0004 16.4426 22.0013 16.9949C22.0023 17.5472 21.5553 17.9956 21.003 17.9966L19.0017 18C18.9591 18.0001 18.9171 17.9975 18.8759 17.9924C18.4345 19.7215 16.8666 21 15 21C12.7909 21 11 19.2091 11 17ZM3 16C2.44772 16 2 16.4477 2 17C2 17.5523 2.44772 18 3 18H8C8.55228 18 9 17.5523 9 17C9 16.4477 8.55228 16 8 16H3Z">
							</path>
						</svg> Filters</button>
					<button class="rounded-3 p-2"
						style="background-color: rgb(239, 242, 245); border: none; font-size: 12px;"><svg
							xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
							color="var(--c-color-gray-500)">
							<path
								d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM13 5V19H9V5H13ZM5 5H7V19H5V5ZM15 19V5H19V19H15Z"
								fill="currentColor"></path>
						</svg> Customize</button>
					<button class="rounded-3 p-2"
						style="background-color: rgb(239, 242, 245); border: none; font-size: 12px;">
						<span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
								class="bi bi-list" viewBox="0 0 16 16">
								<path fill-rule="evenodd"
									d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5" />
							</svg></span>
						<span><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" height="20px" width="20px"
								viewBox="0 0 24 24" class="sc-aef7b723-0 bpKjzE">
								<path fill-rule="evenodd" clip-rule="evenodd"
									d="M5 4C4.44772 4 4 4.44772 4 5V10C4 10.5523 4.44772 11 5 11H10C10.5523 11 11 10.5523 11 10V5C11 4.44772 10.5523 4 10 4H5ZM14 4C13.4477 4 13 4.44772 13 5V10C13 10.5523 13.4477 11 14 11H19C19.5523 11 20 10.5523 20 10V5C20 4.44772 19.5523 4 19 4H14ZM13 14C13 13.4477 13.4477 13 14 13H19C19.5523 13 20 13.4477 20 14V19C20 19.5523 19.5523 20 19 20H14C13.4477 20 13 19.5523 13 19V14ZM5 13C4.44772 13 4 13.4477 4 14V19C4 19.5523 4.44772 20 5 20H10C10.5523 20 11 19.5523 11 19V14C11 13.4477 10.5523 13 10 13H5Z"
									fill="CurrentColor"></path>
							</svg></span>
					</button>
				</div>
				<!-- Other buttons go here -->
			</div>
		</div>
		<table id="cryptoTable">
			<thead>
				<tr>
					<th>#</th>
					<th>Name</th>
					<th>Price</th>
					<th>1h %</th>
					<th>24h %</th>
					<th>7d %</th>
					<th>Market Cap</th>
					<th>Volume (24h)</th>
					<th>Circulating Supply</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script type="module">
		import { instance } from "../../axios/config/config.js";
		const baseURL = instance.defaults.baseURL;
		const apiUrl = baseURL + 'v1/coins/home';
		const apiProfile = baseURL + 'v1/user/own';
		document.getElementById('limitSelect').addEventListener('change', function () {
			const selectedValue = this.value;
			fetchDataAndPopulateTable(apiUrl + "?limit=" + selectedValue);
		});
		// hàm get cookies
		function getCookie(cookieName) {
			var name = cookieName + "=";
			var decodedCookie = decodeURIComponent(document.cookie);
			var cookieArray = decodedCookie.split(';');
			for (var i = 0; i < cookieArray.length; i++) {
				var cookie = cookieArray[i].trim();
				if (cookie.indexOf(name) == 0) {
					return cookie.substring(name.length, cookie.length);
				}
			}
			return null;
		}
		// hiển thị menu và nut login
		document.addEventListener("DOMContentLoaded", function () {
			var buttonLogin = document.getElementById("buttonLogin");
			var menu = document.getElementById("menu");
			// Kiểm tra xem cookie có tồn tại không
			var cookieExists = getCookie('token');
			// Nếu cookie không tồn tại, hiển thị phần tử loginContainer
			if (!cookieExists) {
				buttonLogin.style.display = "block";
			} else {
				menu.style.display = "block";
			}
		});
		// Hàm fetch dữ liệu và điền vào bảng
		function fetchDataAndPopulateTable(apiUrl) {
			axios.get(apiUrl)
				.then(response => {
					if (response.status !== 200) {
						throw new Error(`Error: ${response.status}`);
					}
					return response.data;
				})
				.then(data => {
					populateTable(data.data.data.cryptoCurrencyList);
				})
				.catch(error => {
					console.error('Error fetching data:', error);
				});
		}

		function populateTable(data) {
			const tableBody = document.getElementById('cryptoTable').getElementsByTagName('tbody')[0];
			// Xóa dữ liệu hiện tại trên bảng
			tableBody.innerHTML = '';

			const mapping = {
				'cmcRank': crypto => crypto.cmcRank,
				'name': crypto => `<img src="https://s2.coinmarketcap.com/static/img/coins/64x64/${crypto.id}.png" style="width: 24px; height: 24px;"> <strong>${crypto.name}</strong> <span style="color: rgb(128, 138, 157);">${crypto.symbol}</span>`,
				'price': crypto => crypto.quotes && crypto.quotes[0] ? `<strong>$ ${crypto.quotes[0].price.toLocaleString()}</strong>` : '',
				'percent1h': crypto => `<strong>${formatNumber(crypto.quotes[0].percentChange1h)}%</strong>`,
				'percent24h': crypto => `<strong>${formatNumber(crypto.quotes[0].percentChange24h)}%</strong>`,
				'percent7d': crypto => `<strong>${formatNumber(crypto.quotes[0].percentChange7d)}%</strong>`,
				'marketCap': crypto => `<strong>${crypto.quotes && crypto.quotes[0] ? crypto.quotes[0].marketCap.toLocaleString() : ''}</strong>`,
				'volume24h': crypto => `<strong>${crypto.quotes && crypto.quotes[0] ? crypto.quotes[0].volume24h.toLocaleString() + ' ' + crypto.symbol : ''}</strong>`,
				'circulatingSupply': crypto => `<strong>${crypto.circulatingSupply.toLocaleString() + ' ' + crypto.symbol}</strong>`,
			};

			data.forEach(crypto => {
				const row = tableBody.insertRow();

				Object.keys(mapping).forEach((key, index) => {
					const cell = row.insertCell(index);
					const label = key;
					const value = mapping[key](crypto);

					// Thêm class 'negative' vào ô nếu giá trị là âm
					if (key === 'price' || key === 'marketCap' || key === 'volume24h' || key === 'circulatingSupply') {
						const isNegative = Number(value) < 0;
						cell.className = isNegative ? 'negative' : 'positive';
					}
					cell.innerHTML = `${value}`;
				});
			});
		}
		// Hàm này để định dạng số và thêm màu đỏ cho giá trị âm
		function formatNumber(value) {
			const formattedValue = Number(value).toFixed(2);
			return value < 0 ? formattedValue.fontcolor('red') : formattedValue.fontcolor('green');
		}

		function profile(apiUrl) {
			var authToken = getCookie('token');
			var name = document.getElementById('name');
			const requestConfig = {
				headers: {
					'Authorization': `Bearer ${authToken}`,
				}
			};
			axios.get(apiUrl, requestConfig)
				.then(response => {
					if (response.status !== 200) {
						throw new Error(`Error: ${response.status}`);
					}
					return response.data;
				})
				.then(data => {
					var profile = data;
					name.textContent = profile.data.name;
				})
				.catch(error => {
					console.error('Error fetching data:', error);
				});
		}

		function logout() {
			var cookies = document.cookie.split(";");
			for (var i = 0; i < cookies.length; i++) {
				var cookie = cookies[i];
				var eqPos = cookie.indexOf("=");
				var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
				document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
			}
			window.location.href = window.location.origin + "/html/page/SignInSignUp.html"; // Thay đổi đường dẫn nếu cần
		}

		document.getElementById("logoutButton").addEventListener("click", function () {
			logout();
		});
		// Gọi hàm lần đầu get data về bảng
		fetchDataAndPopulateTable(apiUrl);
		profile(apiProfile);
	</script>
</body>

</html>